import{j as e,m as w,r as j}from"./index-DYQTZkuy.js";import{I as y}from"./Input-BpQJ6sWp.js";import{B as k}from"./Button-MEhtTypU.js";import{C as T}from"./Card-DV-Wb_Gv.js";import{P as D,a as B}from"./api-Dx16Z3SF.js";import{B as E}from"./Badge-CFO5slSc.js";import{A}from"./index-DJHu_ssk.js";const I=({step:s,currentValue:n,onComplete:i,onGoBack:h,isLoading:o=!1,availableSlots:u=[],bookingData:d={}})=>{const p=a=>{i(s.id,a)},x=a=>{a.preventDefault();const t=new FormData(a.currentTarget),m={name:t.get("name"),email:t.get("email"),phone:t.get("phone"),message:t.get("message")};i(s.id,m)},c=(a,t)=>{i(s.id,{date:a,timeSlot:t})},v=()=>{i(s.id,!0)},_=()=>{var a,t,m,N,f;switch(s.type){case"service-selection":return e.jsx("div",{className:"booking-step__services",children:e.jsxs("div",{className:"booking-step__service-options",children:[e.jsxs("div",{className:`booking-step__service-card ${n==="measurement"?"booking-step__service-card--selected":""}`,onClick:()=>p("measurement"),children:[e.jsx("div",{className:"booking-step__service-icon",children:"📏"}),e.jsx("h3",{children:"Free Measurement"}),e.jsx("p",{children:"We'll visit your home to take precise measurements"}),e.jsx("div",{className:"booking-step__service-duration",children:"Duration: 45 minutes"})]}),e.jsxs("div",{className:`booking-step__service-card ${n==="online-consultation"?"booking-step__service-card--selected":""}`,onClick:()=>p("online-consultation"),children:[e.jsx("div",{className:"booking-step__service-icon",children:"💻"}),e.jsx("h3",{children:"Online Consultation"}),e.jsx("p",{children:"Video call to discuss your kitchen project"}),e.jsx("div",{className:"booking-step__service-duration",children:"Duration: 30 minutes"})]}),e.jsxs("div",{className:`booking-step__service-card ${n==="showroom-visit"?"booking-step__service-card--selected":""}`,onClick:()=>p("showroom-visit"),children:[e.jsx("div",{className:"booking-step__service-icon",children:"🏪"}),e.jsx("h3",{children:"Showroom Visit"}),e.jsx("p",{children:"Visit our showroom to see materials and designs"}),e.jsx("div",{className:"booking-step__service-duration",children:"Duration: 60 minutes"})]})]})});case"contact-form":return e.jsxs("form",{onSubmit:x,className:"booking-step__contact-form",children:[e.jsx("div",{className:"booking-step__form-group",children:e.jsx(y,{name:"name",label:"Full Name",placeholder:"Enter your full name",required:!0,disabled:o})}),e.jsx("div",{className:"booking-step__form-group",children:e.jsx(y,{name:"email",type:"email",label:"Email Address",placeholder:"Enter your email",required:!0,disabled:o})}),e.jsx("div",{className:"booking-step__form-group",children:e.jsx(y,{name:"phone",type:"tel",label:"Phone Number",placeholder:"Enter your phone number",required:!0,disabled:o})}),e.jsx("div",{className:"booking-step__form-group",children:e.jsx(y,{name:"message",type:"textarea",label:"Additional Notes (Optional)",placeholder:"Tell us about your project or any specific requirements",disabled:o})}),e.jsx(k,{type:"submit",variant:"primary",size:"lg",disabled:o,className:"booking-step__submit-button",children:"Continue to Date Selection"})]});case"datetime-picker":return e.jsxs("div",{className:"booking-step__datetime",children:[e.jsx("p",{children:"Available time slots:"}),u.length>0?e.jsx("div",{className:"booking-step__time-slots",children:u.map((b,S)=>e.jsx("button",{className:"booking-step__time-slot",onClick:()=>c("2024-01-15",b.time),children:b.time},S))}):e.jsx("p",{children:"Loading available slots..."}),e.jsx(k,{variant:"primary",size:"lg",onClick:()=>c("2024-01-15","10:00"),disabled:o,className:"booking-step__continue-button",children:"Continue to Confirmation"})]});case"confirmation":return e.jsxs("div",{className:"booking-step__confirmation",children:[e.jsxs(T,{className:"booking-step__summary-card",children:[e.jsx("h3",{children:"Booking Summary"}),e.jsxs("div",{className:"booking-step__summary-item",children:[e.jsx("strong",{children:"Service:"})," ",d.serviceType]}),e.jsxs("div",{className:"booking-step__summary-item",children:[e.jsx("strong",{children:"Name:"})," ",(a=d.contact)==null?void 0:a.name]}),e.jsxs("div",{className:"booking-step__summary-item",children:[e.jsx("strong",{children:"Email:"})," ",(t=d.contact)==null?void 0:t.email]}),e.jsxs("div",{className:"booking-step__summary-item",children:[e.jsx("strong",{children:"Phone:"})," ",(m=d.contact)==null?void 0:m.phone]}),e.jsxs("div",{className:"booking-step__summary-item",children:[e.jsx("strong",{children:"Date:"})," ",((N=d.datetime)==null?void 0:N.date)||"TBD"]}),e.jsxs("div",{className:"booking-step__summary-item",children:[e.jsx("strong",{children:"Time:"})," ",((f=d.datetime)==null?void 0:f.timeSlot)||"TBD"]})]}),e.jsx("div",{className:"booking-step__consent",children:e.jsxs("label",{className:"booking-step__checkbox-label",children:[e.jsx("input",{type:"checkbox",checked:n||!1,onChange:b=>i("consent",b.target.checked),disabled:o}),e.jsx("span",{className:"booking-step__checkbox-text",children:"I agree to the terms and conditions and privacy policy"})]})}),e.jsx(k,{variant:"primary",size:"lg",onClick:v,disabled:!n||o,className:"booking-step__confirm-button",children:"Confirm Booking"})]});default:return null}};return e.jsxs("div",{className:"booking-step",children:[e.jsxs("div",{className:"booking-step__header",children:[e.jsx("h2",{className:"booking-step__title",children:s.title}),e.jsx("p",{className:"booking-step__description",children:s.description}),h&&e.jsxs("button",{className:"booking-step__back-button",onClick:h,disabled:o,children:[e.jsx("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:e.jsx("path",{d:"M19 12H5M12 19L5 12L12 5",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"})}),"Back"]})]}),e.jsx("div",{className:"booking-step__content",children:_()}),o&&e.jsxs("div",{className:"booking-step__loading",children:[e.jsx("div",{className:"booking-step__spinner"}),e.jsx("p",{children:"Processing your booking..."})]})]})},O=({progress:s,className:n=""})=>{const i=["booking-progress-bar",n].filter(Boolean).join(" ");return e.jsxs("div",{className:i,children:[e.jsxs("div",{className:"booking-progress-bar__header",children:[e.jsx("h3",{className:"booking-progress-bar__title",children:"Book Your Appointment"}),e.jsxs("span",{className:"booking-progress-bar__step",children:["Step ",Math.ceil(s/100*4)," of 4"]})]}),e.jsx("div",{className:"booking-progress-bar__progress",children:e.jsx(D,{progress:s,variant:"success",animated:!0,showPercentage:!0})}),e.jsx("div",{className:"booking-progress-bar__description",children:e.jsx("p",{children:"Schedule your free consultation in just a few steps"})})]})},P=({confirmation:s,bookingData:n,onRestart:i})=>{var d,p,x;const h=()=>{var m;const c={title:`Kitchen Consultation - ${n.serviceType}`,start:new Date(`${s.date}T${s.time}`),end:new Date(`${s.date}T${s.time}`),description:`Kitchen consultation appointment with ${(m=n.contact)==null?void 0:m.name}`,location:"Custom Kitchens Cyprus"},v=["BEGIN:VCALENDAR","VERSION:2.0","PRODID:-//Custom Kitchens//Booking System//EN","BEGIN:VEVENT",`UID:${s.bookingId}@customkitchens.cy`,`DTSTART:${c.start.toISOString().replace(/[-:]/g,"").split(".")[0]}Z`,`DTEND:${c.end.toISOString().replace(/[-:]/g,"").split(".")[0]}Z`,`SUMMARY:${c.title}`,`DESCRIPTION:${c.description}`,`LOCATION:${c.location}`,"STATUS:CONFIRMED","END:VEVENT","END:VCALENDAR"].join(`\r
`),_=new Blob([v],{type:"text/calendar"}),a=URL.createObjectURL(_),t=document.createElement("a");t.href=a,t.download=`kitchen-consultation-${s.bookingId}.ics`,document.body.appendChild(t),t.click(),document.body.removeChild(t),URL.revokeObjectURL(a)},o=()=>{window.location.href="/contact"},u=c=>{switch(c){case"confirmed":return"success";case"pending":return"warning";case"cancelled":return"error";default:return"info"}};return e.jsxs(w.div,{className:"booking-confirmation",initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.5},children:[e.jsxs("div",{className:"booking-confirmation__header",children:[e.jsx("div",{className:"booking-confirmation__icon",children:"✅"}),e.jsx("h1",{children:"Appointment Confirmed!"}),e.jsx("p",{children:"Your consultation has been successfully booked"})]}),e.jsx("div",{className:"booking-confirmation__details",children:e.jsxs(T,{className:"booking-confirmation__details-card",children:[e.jsxs("div",{className:"booking-confirmation__details-header",children:[e.jsx("h2",{children:"Appointment Details"}),e.jsx(E,{variant:u(s.status),children:s.status.toUpperCase()})]}),e.jsxs("div",{className:"booking-confirmation__details-content",children:[e.jsxs("div",{className:"booking-confirmation__detail-item",children:[e.jsx("strong",{children:"Booking ID:"}),e.jsx("span",{children:s.bookingId})]}),e.jsxs("div",{className:"booking-confirmation__detail-item",children:[e.jsx("strong",{children:"Confirmation Code:"}),e.jsx("span",{className:"booking-confirmation__code",children:s.confirmationCode})]}),e.jsxs("div",{className:"booking-confirmation__detail-item",children:[e.jsx("strong",{children:"Service Type:"}),e.jsx("span",{children:s.serviceType})]}),e.jsxs("div",{className:"booking-confirmation__detail-item",children:[e.jsx("strong",{children:"Date:"}),e.jsx("span",{children:s.date})]}),e.jsxs("div",{className:"booking-confirmation__detail-item",children:[e.jsx("strong",{children:"Time:"}),e.jsx("span",{children:s.time})]}),e.jsxs("div",{className:"booking-confirmation__detail-item",children:[e.jsx("strong",{children:"Contact:"}),e.jsx("span",{children:(d=n.contact)==null?void 0:d.name})]}),e.jsxs("div",{className:"booking-confirmation__detail-item",children:[e.jsx("strong",{children:"Email:"}),e.jsx("span",{children:(p=n.contact)==null?void 0:p.email})]}),e.jsxs("div",{className:"booking-confirmation__detail-item",children:[e.jsx("strong",{children:"Phone:"}),e.jsx("span",{children:(x=n.contact)==null?void 0:x.phone})]})]})]})}),e.jsxs("div",{className:"booking-confirmation__actions",children:[e.jsx(k,{variant:"primary",size:"lg",onClick:h,className:"booking-confirmation__calendar-button",children:"📅 Add to Calendar"}),e.jsx(k,{variant:"secondary",size:"lg",onClick:o,children:"📞 Contact Us"}),e.jsx(k,{variant:"ghost",onClick:i,className:"booking-confirmation__restart",children:"Book Another Appointment"})]}),e.jsxs("div",{className:"booking-confirmation__next-steps",children:[e.jsx("h3",{children:"What's Next?"}),e.jsxs("ul",{children:[e.jsx("li",{children:"You will receive a confirmation email shortly"}),e.jsx("li",{children:"Our team will contact you 24 hours before your appointment"}),e.jsx("li",{children:"Please prepare any questions or inspiration photos"}),e.jsx("li",{children:"If you need to reschedule, contact us at least 24 hours in advance"})]})]}),e.jsx("div",{className:"booking-confirmation__disclaimer",children:e.jsxs("p",{children:[e.jsx("strong",{children:"Important:"})," Please save this confirmation code for your records. You may need it for future reference or to make changes to your appointment."]})})]})},C=[{id:"serviceType",title:"Choose Service Type",description:"Select the type of consultation you need",type:"service-selection"},{id:"contact",title:"Contact Information",description:"Provide your contact details",type:"contact-form"},{id:"datetime",title:"Select Date & Time",description:"Choose your preferred appointment time",type:"datetime-picker"},{id:"confirmation",title:"Confirm Booking",description:"Review and confirm your appointment",type:"confirmation"}],R=({onComplete:s,className:n=""})=>{const[i,h]=j.useState(0),[o,u]=j.useState({consent:!1}),[d,p]=j.useState(!1),[x,c]=j.useState(null),[v,_]=j.useState([]),a=(i+1)/C.length*100,t=(r,l)=>{u(g=>({...g,[r]:l})),r==="serviceType"&&m(l),i<C.length-1?setTimeout(()=>{h(g=>g+1)},300):N()},m=async r=>{try{const l=new Date,g=await B.getAvailableSlots(l,r);_(g)}catch(l){console.error("Error loading available slots:",l)}},N=async()=>{p(!0);try{const r=o,l=await B.bookAppointment(r);c(l),s&&s(r,l)}catch(r){console.error("Booking submission error:",r)}finally{p(!1)}},f=()=>{i>0&&h(r=>r-1)},b=()=>{h(0),u({consent:!1}),c(null),_([])};j.useEffect(()=>{Object.keys(o).length>1&&localStorage.setItem("booking-progress",JSON.stringify({currentStep:i,bookingData:o}))},[i,o]),j.useEffect(()=>{const r=localStorage.getItem("booking-progress");if(r)try{const{currentStep:l,bookingData:g}=JSON.parse(r);h(l),u(g),g.serviceType&&m(g.serviceType)}catch(l){console.error("Error loading booking progress:",l)}},[]);const S=["booking-flow",n].filter(Boolean).join(" ");return x?e.jsx(P,{confirmation:x,bookingData:o,onRestart:b}):e.jsxs("div",{className:S,children:[e.jsx(O,{progress:a}),e.jsx("div",{className:"booking-flow__content",children:e.jsx(A,{mode:"wait",children:e.jsx(w.div,{initial:{opacity:0,x:20},animate:{opacity:1,x:0},exit:{opacity:0,x:-20},transition:{duration:.3},children:e.jsx(I,{step:C[i],currentValue:o[C[i].id],onComplete:t,onGoBack:i>0?f:void 0,isLoading:d,availableSlots:v,bookingData:o})},i)})})]})},F=()=>{const s=(n,i)=>{console.log("Booking completed:",{data:n,confirmation:i})};return e.jsx("div",{className:"booking-page",children:e.jsxs("div",{className:"container",children:[e.jsxs("div",{className:"booking-page__header",children:[e.jsx("h1",{children:"Book Your Appointment"}),e.jsx("p",{children:"Schedule your free consultation or measurement visit"})]}),e.jsx("div",{className:"booking-page__content",children:e.jsx(R,{onComplete:s})})]})})};export{F as default};
